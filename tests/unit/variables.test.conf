# SYNTAX TEST "source.seclang" "Variables and pipes"

SecRule ARGS:username "@rx ^[a-z]+$" "id:501,phase:2,deny"
#^^^^^^ keyword.control.directive.seclang
#       ^^^^ variable.language.seclang
#                      ^^^ support.function.seclang
#                                     ^^^ keyword.other.id.seclang
#                                            ^^^^^^ keyword.other.phase.seclang
#                                                    ^^^^ keyword.control.disruptive.seclang

SecRule ARGS|REQUEST_HEADERS|REQUEST_COOKIES "@rx attack" "id:503,phase:2,deny"
#^^^^^^ keyword.control.directive.seclang
#       ^^^^ variable.language.seclang
#           ^ keyword.operator.pipe.seclang
#                           ^ keyword.operator.pipe.seclang
#                                             ^^^ support.function.seclang
#                                                          ^^^ keyword.other.id.seclang
#                                                                 ^^^^^^ keyword.other.phase.seclang
#                                                                         ^^^^ keyword.control.disruptive.seclang

SecRule !ARGS "@rx skip" "id:504,phase:1,pass"
#^^^^^^ keyword.control.directive.seclang
#       ^ keyword.operator.logical.seclang
#        ^^^^ variable.language.seclang
#              ^^^ support.function.seclang
#                                        ^^^^ keyword.control.action.seclang

SecRule &ARGS "@gt 10" "id:505,phase:1,deny"
#^^^^^^ keyword.control.directive.seclang
#       ^ keyword.operator.count.seclang
#        ^^^^ variable.language.seclang
#              ^^^ support.function.seclang
#                                      ^^^^ keyword.control.disruptive.seclang

