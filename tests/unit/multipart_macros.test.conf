# SYNTAX TEST "source.seclang" "Multi-line SecRule with macros in msg"

SecRule MULTIPART_STRICT_ERROR "!@eq 0" \
#^^^^^^ keyword.control.directive.seclang
#       ^^^^^^^^^^^^^^^^^^^^^^ variable.language.seclang
#                               ^ keyword.operator.logical.seclang
#                                ^^^ support.function.seclang

"id:'200003',phase:2,t:none,log,deny,status:400, \
#^^^ keyword.other.id.seclang
#            ^^^^^^ keyword.other.phase.seclang
#                           ^^^ keyword.control.action.seclang
#                               ^^^^ keyword.control.disruptive.seclang
#                                    ^^^^^^^ keyword.other.status.seclang
#                                           ^^^ constant.numeric.seclang

msg:'Multipart request body failed strict validation: \
#^^^ keyword.other.msg.seclang

PE %{REQBODY_PROCESSOR_ERROR}'"
#  ^^ punctuation.definition.macro.begin.seclang
#    ^^^^^^^^^^^^^^^^^^^^^^^ variable.other.readwrite.seclang
#                           ^ punctuation.definition.macro.end.seclang

SecRule ARGS:_charset_ "!@within |%{tx.allowed_request_content_type_charset}|" \
#^^^^^^ keyword.control.directive.seclang
#       ^^^^^ variable.language.seclang
#                                ^ string.unquoted.seclang
#                                 ^^ punctuation.definition.macro.begin.seclang
#                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ variable.other.readwrite.seclang
#                                                                          ^ punctuation.definition.macro.end.seclang
#                                                                           ^ string.unquoted.seclang

"setvar:'tx.score=+%{tx.critical_anomaly_score}'"
#^^^^^^^ keyword.other.setvar.seclang
#                  ^^ punctuation.definition.macro.begin.seclang
#                    ^^^^^^^^^^^^^^^^^^^^^^^^^ variable.other.readwrite.seclang

